<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Data Sources · Query.jl</title><link href="https://cdnjs.cloudflare.com/ajax/libs/normalize/4.2.0/normalize.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.5.0/styles/default.min.css" rel="stylesheet" type="text/css"/><link href="https://fonts.googleapis.com/css?family=Lato|Ubuntu+Mono" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" type="text/css"/><link href="assets/documenter.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.2.0/require.min.js" data-main="assets/documenter.js"></script><script src="../versions.js"></script></head><body><nav class="toc"><h1>Query.jl</h1><form class="search" action="search.html"><select id="version-selector" onChange="window.location.href=this.value"><option value="#" selected="selected" disabled="disabled">Version</option></select><input id="search-query" name="q" type="text" placeholder="Search docs"/></form><ul><li><a class="toctext" href="index.html">Introduction</a></li><li><a class="toctext" href="gettingstarted.html">Getting Started</a></li><li><a class="toctext" href="querycommands.html">Query Commands</a></li><li class="current"><a class="toctext" href="sources.html">Data Sources</a><ul class="internal"><li><a class="toctext" href="#DataFrame-1">DataFrame</a></li><li><a class="toctext" href="#TypedTable-1">TypedTable</a></li><li><a class="toctext" href="#Arrays-1">Arrays</a></li><li><a class="toctext" href="#DataStream-1">DataStream</a></li><li><a class="toctext" href="#IndexedTables-1">IndexedTables</a></li><li><a class="toctext" href="#Any-iterable-type-1">Any iterable type</a></li></ul></li><li><a class="toctext" href="sinks.html">Data Sinks</a></li><li><a class="toctext" href="internals.html">Internals</a></li></ul></nav><article id="docs"><header><nav><ul><li><a href="sources.html">Data Sources</a></li></ul><a class="edit-page" href="https://github.com/davidanthoff/Query.jl/tree/ea1f2916de5da5698f61d8aa7789dc7bed3d2245/docs/src/sources.md"><span class="fa"></span> Edit on GitHub</a></nav><hr/></header><h1><a class="nav-anchor" id="Data-Sources-1" href="#Data-Sources-1">Data Sources</a></h1><p>Query supports many different types of data sources, and you can often mix and match different source types in one query. This section describes all the currently supported data source types.</p><h2><a class="nav-anchor" id="DataFrame-1" href="#DataFrame-1">DataFrame</a></h2><p><code>DataFrame</code>s are probably the most common data source in Query. They are implemented as an <code>Enumerable</code> data source type, and can therefore be combined with any other <code>Enuermable</code> data source type within one query. The range variable in a query that has a <code>DataFrame</code> as its source is a <code>NamedTuple</code> that has fields for each column of the <code>DataFrame</code>. The implementation of <code>DataFrame</code> sources gets around all problems of type stability that are sometimes associated with the <code>DataFrames</code> package.</p><h3><a class="nav-anchor" id="Example-1" href="#Example-1">Example</a></h3><pre><code class="language-julia">using Query, DataFrames

df = DataFrame(name=[&quot;John&quot;, &quot;Sally&quot;, &quot;Kirk&quot;], age=[23., 42., 59.], children=[3,5,2])

x = @from i in df begin
    @select i
    @collect DataFrame
end

println(x)

# output

3×3 DataFrames.DataFrame
│ Row │ name    │ age  │ children │
├─────┼─────────┼──────┼──────────┤
│ 1   │ &quot;John&quot;  │ 23.0 │ 3        │
│ 2   │ &quot;Sally&quot; │ 42.0 │ 5        │
│ 3   │ &quot;Kirk&quot;  │ 59.0 │ 2        │</code></pre><h2><a class="nav-anchor" id="TypedTable-1" href="#TypedTable-1">TypedTable</a></h2><p>The <code>TypedTables</code> package provides an alternative implementation of a DataFrame-like data structure. Support for <code>TypedTable</code> data sources works in the same way as normal <code>DataFrame</code> sources, i.e. columns are represented as fields of <code>NamedTuples</code>. <code>TypedTable</code> sources are implemented as  <code>Enumerable</code> data source and can therefore be combined with any other <code>Enumerable</code> data source in a single query.</p><h3><a class="nav-anchor" id="Example-2" href="#Example-2">Example</a></h3><pre><code class="language-julia">using Query, DataFrames, TypedTables

tt = @Table(name=[&quot;John&quot;, &quot;Sally&quot;, &quot;Kirk&quot;], age=[23., 42., 59.], children=[3,5,2])

x = @from i in tt begin
    @select i
    @collect DataFrame
end

println(x)

# output

3×3 DataFrames.DataFrame
│ Row │ name    │ age  │ children │
├─────┼─────────┼──────┼──────────┤
│ 1   │ &quot;John&quot;  │ 23.0 │ 3        │
│ 2   │ &quot;Sally&quot; │ 42.0 │ 5        │
│ 3   │ &quot;Kirk&quot;  │ 59.0 │ 2        │</code></pre><h2><a class="nav-anchor" id="Arrays-1" href="#Arrays-1">Arrays</a></h2><p>Any array can be a data source for a query. The range variables are of the element type of the array and the elements are iterated in the order of the standard iterator of the array. Array sources are implemented as <code>Enumerable</code> data sources and can therefore be combined with any other <code>Enumerable</code> data source in a single query.</p><h3><a class="nav-anchor" id="Example-3" href="#Example-3">Example</a></h3><pre><code class="language-julia">using Query, DataFrames

immutable Person
    Name::String
    Friends::Vector{String}
end

source = Array(Person,0)
push!(source, Person(&quot;John&quot;, [&quot;Sally&quot;, &quot;Miles&quot;, &quot;Frank&quot;]))
push!(source, Person(&quot;Sally&quot;, [&quot;Don&quot;, &quot;Martin&quot;]))

result = @from i in source begin
         @where length(i.Friends) &gt; 2
         @select {i.Name, Friendcount=length(i.Friends)}
         @collect
end

println(result)

# output

NamedTuples._NT_Name_Friendcount{String,Int64}[(Name = &quot;John&quot;, Friendcount = 3)]</code></pre><h2><a class="nav-anchor" id="DataStream-1" href="#DataStream-1">DataStream</a></h2><p>Any <code>DataStream</code> source can be a source in a query. This includes CSV.jl, Feather.jl and SQLite.jl sources (these are currenlty tested as part of Query.jl). Individual rows of these sources are represented as <code>NamedTuple</code> elements that have fields for all the columns of the data source. <code>DataStreams</code> sources are implemented as <code>Enumerable</code> data sources and can therefore be combined with any other <code>Enumerable</code> data source in a single query.</p><h3><a class="nav-anchor" id="Example-4" href="#Example-4">Example</a></h3><p>This example reads a CSV file:</p><pre><code class="language-julia">using Query, DataStreams, CSV

q = @from i in CSV.Source(joinpath(Pkg.dir(&quot;Query&quot;),&quot;example&quot;, &quot;data.csv&quot;)) begin
    @where i.Children &gt; 2
    @select i.Name
    @collect
end

println(q)

# output

Query.DataValue{String}[&quot;John&quot;,&quot;Kirk&quot;]</code></pre><p>This example reads a Feather file:</p><pre><code class="language-julia">using Query, DataStreams, Feather

q = @from i in Feather.Source(joinpath(Pkg.dir(&quot;Feather&quot;),&quot;test&quot;, &quot;data&quot;, &quot;airquality.feather&quot;)) begin
    @where i.Day==2
    @select i.Month
    @collect
end

println(q)

# output

WARNING: This Feather file is old and will not be readable beyond the 0.3.0 release
Query.DataValue{Int32}[5,6,7,8,9]</code></pre><h2><a class="nav-anchor" id="IndexedTables-1" href="#IndexedTables-1">IndexedTables</a></h2><p><code>NDSparse</code> data sources can be a source in a query. Individual rows are represented as a <code>NamedTuple</code> with two fields. The <code>index</code> field holds the index data for this row. If the source has named columns, the type of the <code>index</code> field is a <code>NamedTuple</code>, where the fieldnames correspond to the names of the index columns. If the source doesn&#39;t use named columns, the type of the <code>index</code> field is a regular tuple. The second field is named <code>value</code> and holds the value of the row in the original source. <code>NDSparse</code> sources are implemented as <code>Enumerable</code> data sources and can therefore be combined with any other <code>Enumerable</code> data source in a single query.</p><h3><a class="nav-anchor" id="Example-5" href="#Example-5">Example</a></h3><pre><code class="language-julia">using Query, IndexedTables

source_ndsparsearray = NDSparse(Columns(city = [fill(&quot;New York&quot;,3); fill(&quot;Boston&quot;,3)], date = repmat(Date(2016,7,6):Date(2016,7,8), 2)), [91,89,91,95,83,76])

q = @from i in source_ndsparsearray begin
    @where i.index.city==&quot;New York&quot;
    @select i.value
    @collect
end

println(q)

# output

[91,89,91]</code></pre><h2><a class="nav-anchor" id="Any-iterable-type-1" href="#Any-iterable-type-1">Any iterable type</a></h2><p>Any data source type that implements the standard julia iterator protocoll (i.e. a <code>start</code>, <code>next</code> and <code>done</code> method) can be a query data source. Iterable data sources are implemented as <code>Enumerable</code> data sources and can therefore be combined with any other <code>Enumerable</code> data source in a single query.</p><h3><a class="nav-anchor" id="Example-6" href="#Example-6">Example</a></h3><p>[TODO]</p><footer><hr/><a class="previous" href="querycommands.html"><span class="direction">Previous</span><span class="title">Query Commands</span></a><a class="next" href="sinks.html"><span class="direction">Next</span><span class="title">Data Sinks</span></a></footer></article></body></html>
