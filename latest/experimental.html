<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Experimental Features · Query.jl</title><link href="https://cdnjs.cloudflare.com/ajax/libs/normalize/4.2.0/normalize.min.css" rel="stylesheet" type="text/css"/><link href="https://fonts.googleapis.com/css?family=Lato|Roboto+Mono" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/default.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.2.0/require.min.js" data-main="assets/documenter.js"></script><script src="siteinfo.js"></script><script src="../versions.js"></script><link href="assets/documenter.css" rel="stylesheet" type="text/css"/></head><body><nav class="toc"><h1>Query.jl</h1><select id="version-selector" onChange="window.location.href=this.value" style="visibility: hidden"></select><form class="search" action="search.html"><input id="search-query" name="q" type="text" placeholder="Search docs"/></form><ul><li><a class="toctext" href="index.html">Introduction</a></li><li><a class="toctext" href="gettingstarted.html">Getting Started</a></li><li><a class="toctext" href="querycommands.html">Query Commands</a></li><li><a class="toctext" href="sources.html">Data Sources</a></li><li><a class="toctext" href="sinks.html">Data Sinks</a></li><li class="current"><a class="toctext" href="experimental.html">Experimental Features</a><ul class="internal"><li><a class="toctext" href="#Standalone-query-operators-1">Standalone query operators</a></li><li><a class="toctext" href="#The-..-syntax-1">The <code>..</code> syntax</a></li><li><a class="toctext" href="#The-_-syntax-1">The <code>_</code> syntax</a></li></ul></li><li><a class="toctext" href="internals.html">Internals</a></li></ul></nav><article id="docs"><header><nav><ul><li><a href="experimental.html">Experimental Features</a></li></ul><a class="edit-page" href="https://github.com/davidanthoff/Query.jl/tree/63c7bc625bfb912bf912b5eff60f2782d043ea7c/docs/src/experimental.md"><span class="fa"></span> Edit on GitHub</a></nav><hr/><div id="topbar"><span>Experimental Features</span><a class="fa fa-bars" href="#"></a></div></header><h1><a class="nav-anchor" id="Experimental-features-1" href="#Experimental-features-1">Experimental features</a></h1><p>The following features are experimental, i.e. they might change significantly in the future. You are advised to only use them if you are prepared to deal with significant changes to these features in future versions of Query.jl. At the same time any feedback on these features would be especially welcome.</p><p>The <code>@select</code>, <code>@where</code>, <code>@groupby</code> and <code>@orderby</code> (and various variants) commands can be used in standalone versions. Those standalone versions are especially convenient in combination with the pipe syntax in julia. Here is an example that demonstrates their use:</p><pre><code class="language-julia">using Query, DataFrames

df = DataFrame(a=[1,1,2,3], b=[4,5,6,8])

df2 = df |&gt;
    @groupby(_.a) |&gt;
    @select({a=_.key, b=mean(_..b)}) |&gt;
    @where(_.b &gt; 5) |&gt;
    @orderby_descending(_.b) |&gt;
    DataFrame</code></pre><p>This example makes use of three experimental features: 1) the standalone query commands, 2) the <code>..</code> syntax and 3) the <code>_</code> anonymous function syntax.</p><h2><a class="nav-anchor" id="Standalone-query-operators-1" href="#Standalone-query-operators-1">Standalone query operators</a></h2><p>All standalone query commands can either take a source as their first argument, or one can pipe the source into the command, as in the above example. For example, one can either write</p><pre><code class="language-julia">df = df |&gt; @groupby(_.a)</code></pre><p>or</p><pre><code class="language-julia">df = @groupbe(df, _.a)</code></pre><p>both forms are equivalent.</p><p>The remaining arguments of each query demand are command specific.</p><p>The following discussion will present each command in the version that accepts a source as the first argument.</p><h3><a class="nav-anchor" id="The-@select-command-1" href="#The-@select-command-1">The <code>@select</code> command</a></h3><p>The <code>@select</code> command has the form <code>@select(source, element_selector)</code>. <code>source</code> can be any source that can be queried. <code>element_selector</code> must be an anonymous function that accepts one element of the element type of the source and applies some transformation to this single element.</p><h3><a class="nav-anchor" id="The-@where-command-1" href="#The-@where-command-1">The <code>@where</code> command</a></h3><p>The <code>@where</code> command has the form <code>@where(source, filter_condition)</code>. <code>source</code> can be any source that can be queried. <code>filter_condition</code> must be an anonymous function that accepts one element of the element type of the source and returns <code>true</code> if that element should be retained, and <code>false</code> if that element should be filtered out.</p><h3><a class="nav-anchor" id="The-@groupby-command-1" href="#The-@groupby-command-1">The <code>@groupby</code> command</a></h3><p>There are two versions of the <code>@groupby</code> command. The simple version has the form <code>@groupby(source, key_selector)</code>. <code>source</code> can be any source that can be queried. <code>key_selector</code> must be an anonymous function that returns a value for each element of <code>source</code> by which the source elements should be grouped.</p><p>The second variant has the form <code>@groupby(source, key_selector, element_selector)</code>. The definition of <code>source</code> and <code>key_selector</code> is the same as in the simple variant. <code>element_selector</code> must be an anonymous function that is applied to each element of the <code>source</code> before that element is placed into a group, i.e. this is a projection function.</p><h3><a class="nav-anchor" id="The-@orderby,-@orderby_descending,-@thenby-and-@thenby_descending-command-1" href="#The-@orderby,-@orderby_descending,-@thenby-and-@thenby_descending-command-1">The <code>@orderby</code>, <code>@orderby_descending</code>, <code>@thenby</code> and <code>@thenby_descending</code> command</a></h3><p>There are four commands that are used to sort data. Any sorting has to start with either a <code>@orderby</code> or <code>@orderby_descending</code> command. <code>@thenby</code> and <code>@thenby_descending</code> commands can only directly follow a previous sorting command. They specify how ties in the previous sorting condition are to be resolved.</p><p>The general sorting command form is <code>@orderby(source, key_selector)</code>. <code>source</code> can be any source than can be queried. <code>key_selector</code> must be an anonymous function that returns a value for each element of <code>source</code>. The elements of the source are then sorted is ascending order by the value returned from the <code>key_selector</code> function. The <code>@orderby_descending</code> command works in the same way, but sorts things in descending order. The <code>@thenby</code> and <code>@thenby_descending</code> command only accept the return value of any of the four sorting commands as their <code>source</code>, otherwise they have the same syntax as the <code>@orderby</code> and <code>@orderby_descending</code> commands.</p><h2><a class="nav-anchor" id="The-..-syntax-1" href="#The-..-syntax-1">The <code>..</code> syntax</a></h2><p>The syntax <code>a..b</code> is translated into <code>map(i-&gt;i.b, a)</code> in any query expression. This is especially helpful when computing some reduction of a given column of a grouped table.</p><p>For example, the following command groups a table by column <code>a</code>, and then computes the mean of the <code>b</code> column for each group:</p><pre><code class="language-julia">using DataFrames, Query

df = DataFrame(a=[1,1,2,3], b=[4,5,6,8])

@from i in df begin
    @group i by i.a into g
    @select {a=i.key, b=mean(g..b)}
    @collect DataFrame
end</code></pre><p>The <code>@group</code> command here creates a list of tables, i.e. <code>g</code> will hold a full table for each group. The syntax <code>g..b</code> then extracts a single column from that table.</p><h2><a class="nav-anchor" id="The-_-syntax-1" href="#The-_-syntax-1">The <code>_</code> syntax</a></h2><p>This syntax only works in the standalone query commands. Instead of writing a full anonymous function, for example <code>@select(i-&gt;i.a)</code>, one can write <code>@select(_.a)</code>, where <code>_</code> stands for the current element, i.e. has the same role as the argument of the anonymous function.</p><footer><hr/><a class="previous" href="sinks.html"><span class="direction">Previous</span><span class="title">Data Sinks</span></a><a class="next" href="internals.html"><span class="direction">Next</span><span class="title">Internals</span></a></footer></article></body></html>
